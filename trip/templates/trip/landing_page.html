{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}


{% block metadescription %}
<meta name="description" content="Landing page.">
{% endblock %}

{% block content %}
<div class="row container-fluid d-flex flex-column align-items-center  mx-0 px-0">
    <section id='hero-section' class="container my-4 col-12 " aria-labelledby="hero-heading">
        <div class="row p-4 pb-0 pe-lg-0 pt-lg-5 align-items-center rounded-3 border shadow-lg flex-lg-row-reverse">
            <div class="col-lg-4 offset-lg-1 p-0 overflow-hidden shadow-lg">
                <img id='hero-img' class="c-img" alt="Map image with pinned locations" width="400" height="267"
                    src="{% static 'images/hero.webp' %}">
            </div>
            <div class="col-lg-7 p-3 p-lg-5 pt-lg-3">
                <h1 class="display-4 fw-bold lh-1 text-body-emphasis hero-heading">
                    Map Your Adventures, Share Your Stories
                </h1>
                <p class="fs-4 hero-heading">
                    Discover new places, share your travel experiences, and connect with fellow explorers.
                </p>
                <div class="d-grid gap-2 d-md-flex w-100 justify-content-md-center mb-4 mt-4 mb-lg-3">
                    {% if not user.is_authenticated %}
                    <div>
                        <a href="{% url 'account_login' %}" class="btn btn-primary btn-lg px-4 me-md-2 fw-bold">
                            Add Your Trip
                        </a>
                        {% else %}
                        <a href="{% url 'user' %}" class="btn btn-outline-primary btn-lg px-4 me-md-2 fw-bold ">
                            Add Your Trip
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    {% if testimonials %}
    <section id="carousel-testimonials" class="container col-12 " aria-labelledby="testimonials-header">
        <h2 class="text-center mt-1" id="testimonials-header">What our users say </h2>
        <h3 class="visually-hidden">Testimonials</h3>
        <div id="testimonials" class="row carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                {% for testimonial in testimonials %}

                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <div class="testimonial-card text-center">
                        <strong class="testimonial-text">
                            "{{ testimonial.body }}"
                        </strong>
                        <div class="testimonial-author mb-2">
                            @{{ testimonial.author_name }}
                            <br>
                            <small class="text-center text-muted">
                                {{ testimonial.user_info }}
                            </small>
                            <small class="text-muted float-end fst-italic fst-light">
                                Posted at: {{ testimonial.created_at }}
                            </small>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}


    <!-- Map section -->

    <!-- Leaflet -->
    {{ trips | json_script:"trips_json" }}

    <section id="map-section" class="container col-12 mt-2" aria-labelledby="leaflet-map-title">
        <h2 id="leaflet-map-title" class="text-center">Explore the World with Our Interactive Map</h2>
        <div class="row p-3 testimonial-card align-items-center h-100 mb-4">
            <div class="col-lg-4 ">
                <h2 class="visually-hidden">Map filter</h2>
                <form id="tripSelectionForm" style="margin-top: 1.2em;">
                    {% csrf_token %}
                    {{ trip_filter_form | crispy }}
                    <div class="d-flex justify-content-around">
                        <button id="submitButton" type="submit" class="btn btn-signup"
                            aria-label="Submit map filter query">
                            Submit
                        </button>
                        <button id="clearButton" type="button" class="btn btn-more" href="{%  url 'home' %}"
                            aria-label="Clear all filters and reset the map">
                            Clear all
                        </button>
                    </div>
                </form>
            </div>

            <div class="col-lg-8 d-flex flex-columns">
                <div class="container testimonial-card">
                    <div id="map" class="c_map mx-auto"></div>
                </div>
            </div>

        </div>
    </section>

</div>

<script src="{% static 'js/leaflet_map.js' %}" type="text/javascript" defer></script>
<script src="{% static 'js/manage_jquery.js' %}" type="text/javascript" defer></script>

{% endblock content%}
